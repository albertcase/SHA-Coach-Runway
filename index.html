<!DOCTYPE HTML><html><head><title>COACH2017秋冬时装周</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="format-detection" content="telephone=no"><meta name="screen-orientation" content="landscape"><meta name="x5-orientation" content="landscape"><meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0,minimal-ui"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="Keywords" content=""><meta name="Description" content="..."><link rel="stylesheet" type="text/css" href="/build/assets/css/swiper.min.css"><link rel="stylesheet" type="text/css" href="/build/assets/css/main.min.css"><style type="text/css">
        #orientLayer { display: block; }
        @media screen and (min-aspect-ratio: 13/9) { 
            #orientLayer { display: none; } 
        }
    </style><script type="text/javascript" src="http://coach.samesamechina.com/api/v1/js/75058010-0fe1-476a-88f8-f96ffab561c8/wechat"></script></head><body><div class="loading"><div class="loading_con"><img src="/build/assets/img/logo.png" width="100%"><div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div><p>目前涌入的小伙伴过多<br>页面正在跳转中，请耐心等待。</p></div></div><div id="orientLayer" class="mod-orient-layer"><div class="mod-orient-layer__content"><i class="icon mod-orient-layer__icon-orient"></i><div class="mod-orient-layer__desc">为了更好的体验，请解锁横屏浏览<br><em>建议全程在wifi环境下观看</em></div></div></div><div id="dreambox"><p style="display:none"><img id="img1" src="" sourcesrc="/build/assets/img/blue.png" alt=""> <img id="img2" src="" sourcesrc="/build/assets/img/orange.png" alt=""> <img id="img3" src="" sourcesrc="/build/assets/img/green.png" alt=""> <img id="img4" src="" sourcesrc="/build/assets/img/pink.png" alt=""></p><div class="section" id="guide"><div class="guideCon"><a href="javascript:void(0);" class="startBtn"></a></div></div><div class="section" id="stage"><a href="javascript:;" class="pass" style="position: absolute; left: 0; top:0; font-size:1.6rem; color: #f60; z-index: 9; text-align: center; padding: 6px 0; width: 10%; opacity: 0;">跳过</a><dl><dd><div class="poster"></div><video width="100%" height="100%" id="show" x-webkit-airplay="true" preload="" playsinline="" webkit-playsinline="" src="http://nyfwfall2017video.samesamechina.com/build/assets/video/c.mp4"></video></dd><dt><div class="proPop"></div><div class="proInfoPop"><a href="javascript:void(0)" class="pclose"><img src="" sourcesrc="/build/assets/img/close.png" width="100%"></a><div class="proInfoPop_con"></div></div><div class="wishlist"><img src="" sourcesrc="/build/assets/img/bag.png" width="100%"> <em>0</em></div><div class="chatlist"><ul id="chatArea"><li>通通加入心愿单~</li></ul></div><div class="chat"><div class="chatfooter"><div class="msg"><input type="text" placeholder="通通加入心愿单" name="msgText" class="msgText" readonly=""><ul><li>通通加入心愿单~</li><li>天啦噜，每一款都想慢镜头好好欣赏一番！</li><li>新款的颜值已经超越天际，皮皮虾~我们走！</li><li>太幸福了，看中得几款，都可以在线买</li><li>每一件都看到爆炸，心愿单已经写不下了！</li></ul><input type="button" name="send" class="send" value="发送"></div></div><div class="paopao"><canvas id="myCanvas">您的浏览器不支持canvas标签~</canvas><a href="javascript:void(0);" class="heart"><img src="" sourcesrc="/build/assets/img/heart.png" width="100%"></a></div></div></dt></dl></div><div class="section" id="list"><img src="" sourcesrc="/build/assets/img/list-header.jpg" width="100%"><div class="listCon"><div class="swiper-container" id="swiper-3"><div class="swiper-wrapper" id="prolistCon"></div><div class="swiper-button-next"></div><div class="swiper-button-prev"></div></div></div></div></div><script type="text/javascript" src="/build/assets/js/main.min.js"></script><script type="text/javascript">
    var allimg = [
        "/build/assets/img/add.png",
        "/build/assets/img/addCart.jpg",
        "/build/assets/img/arr_l.png",
        "/build/assets/img/arr_r.png",
        "/build/assets/img/bag.png",
        "/build/assets/img/close.png",
        "/build/assets/img/heart.png",
        "/build/assets/img/list-header.jpg",
        "/build/assets/img/mlink.png",
        "/build/assets/img/poster.jpg",
        "/build/assets/img/replay.jpg",
        "/build/assets/img/share.jpg",

        "/build/assets/img/logo.png",
        "/build/assets/img/guide.jpg",

        "/build/assets/img/blue.png",
        "/build/assets/img/orange.png",
        "/build/assets/img/green.png",
        "/build/assets/img/pink.png",
        "/build/assets/video/c.mp4",

        "/build/assets/img/pro/1/l.jpg",
        "/build/assets/img/pro/1/pb.jpg",
        "/build/assets/img/pro/1/pw.jpg",
        "/build/assets/img/pro/2/l.jpg",
        "/build/assets/img/pro/2/pb.jpg",
        "/build/assets/img/pro/2/pw.jpg",
        "/build/assets/img/pro/3/l.jpg",
        "/build/assets/img/pro/3/pb.jpg",
        "/build/assets/img/pro/3/pw.jpg",
        "/build/assets/img/pro/4/l.jpg",
        "/build/assets/img/pro/4/pb.jpg",
        "/build/assets/img/pro/4/pw.jpg",
        "/build/assets/img/pro/5/l.jpg",
        "/build/assets/img/pro/5/pb.jpg",
        "/build/assets/img/pro/5/pw.jpg",
    ];

    var wishcookie = pfun.getCookie("wish"), historyWish = wishcookie;
    var showId = document.getElementById("show"), timeArr = [], wishArr = !wishcookie ? [] : (wishcookie.split(',')),
        porinfoArr = {
            "price": ["", "RMB4,950", "RMB4,950", "RMB4,950", "RMB3,950", "RMB3,950"],
            "num": ["", "123", "356", "789", "908", "367"],
            "link": [
                "", 
                "http://china.coach.com/product/21052_BPF8Q/detail.htm?collection=buynow",
                "http://china.coach.com/product/21053_BPBLK/detail.htm?collection=buynow",
                "http://china.coach.com/product/21050_BPCHK/detail.htm?collection=buynow",
                "http://china.coach.com/product/21051_BPMIW/detail.htm?collection=buynow",
                "http://china.coach.com/product/21051_BPVIO/detail.htm?collection=buynow"
            ]
        };



    $(".msgText").focus(function(e){
        $(".msg ul").css({"visibility": "visible"});
        e.preventDefault();
    })
    // .blur(function(){
    //     $(".msg ul").css({"visibility": "hidden"});
    // })

    $(".msg li").on("click", function(e){
        $(".msgText").val($(this).text());
        $(".msg ul").css({"visibility": "hidden"});
        e.preventDefault();
    })

    $("#chatArea").on("touchstart", function(){
        $(".msg ul").css({"visibility": "hidden"});
    })

    $(".send").on("click", function(){
        chatFun($(".msgText").val());
        $(".msgText").val("");
    })



    var demo, setDemo, chatset, swiper1, swiper2, swiper3;
    window.onload = function(){


    // window.onorientationchange = function(){
    //     switch(window.orientation){
    //         case -90:
    //         case 90:
    //         // $("#show").css({"width": "100%"});
    //         // alert("横屏:" + window.orientation);
    //         case 0:
    //         case 180:
    //         // $("#show").css({"width": "0"});
    //         //alert("竖屏:" + window.orientation);
    //         break;
    //     }
    // } 


      // 使用demo
      
      // demo2
      demo = new JumpBubble({
        elCanvas : document.getElementById("myCanvas"),
        config : {
          alpha : 0.5,
          width : 27
        },
        callback : function(a,b,c){}
      });
      clearInterval(setDemo);
      setDemo = setInterval(function(){
        var idName = "img" + Math.ceil(Math.random()*4);
        demo.create({
          elImg : document.getElementById(idName)
        });
      },290);



      $(".heart").on("touchstart", function(){
        //console.log(6);
        clearInterval(setDemo);
        setDemo = setInterval(function(){
            var idName = "img" + Math.ceil(Math.random()*4);
            demo.create({
              elImg : document.getElementById(idName)
            });
        },170);
      }).on("touchend", function(){
        //console.log(9);
        clearInterval(setDemo);
        setDemo = setInterval(function(){
            var idName = "img" + Math.ceil(Math.random()*4);
            demo.create({
              elImg : document.getElementById(idName)
            });
        },290);
      })

    }

    // 产品弹出

    // '<a href="javascript:void(0);" class="mlink">' +
    //                         '<img src="/build/assets/img/mlink.png" width="100%">' +
    //                     '</a>' +
    var setTime;
    function propopFun(n){
        clearTimeout(setTime);
        var popHTML = '<div class="proPop_con fadeInUp animated" data-id="'+ n +'">' +
                        '<img src="/build/assets/img/pro/'+ n +'/pw.jpg" width="100%">' +
                    '</div>';
        $(".proPop").html(popHTML).fadeIn();
        

        setTime = setTimeout(function(){
            $(".proPop_con").removeClass("fadeInUp animated");
            $(".proPop").fadeOut().html("");
        }, 6000)

    }

    $(".proPop").delegate(".proPop_con", "click", function(){
        var currentNum = $(this).attr("data-id");
        //console.log(currentNum);
        //swiper2.slideTo(currentNum, 1000, false);
        proInfoPopFun(currentNum);
        showId.pause();
    })


    

    pfun.eventTester(showId, "timeupdate", function(e){
        console.log(showId.currentTime);
        if(timeArr.indexOf(parseInt(showId.currentTime)) < 0){
            if(parseInt(showId.currentTime) == 13){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(4);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 30){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(5);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 83){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(1);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 105){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(3);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 136){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(2);
                //console.log(timeArr);
            }else {

            }
        }
        //console.log(parseInt(showId.currentTime))   
    });

    $(".poster").on("touchstart", function(){
        showId.play();
        $(this).hide();
    })


    // 随机聊天 
    var chatText = [
        "通通加入心愿单~",
        "天啦噜，每一款都想慢镜头好好欣赏一番！",
        "新款的颜值已经超越天际，皮皮虾~我们走！",
        "太幸福了，看中得几款，都可以在线买",
        "每一件都看到爆炸，心愿单已经写不下了！"
    ];

    function chatFun(t){
        var li = document.createElement('li');
            li.innerHTML = t;
            document.querySelector('#chatArea').appendChild(li);

        // 设置内容区的滚动条到底部
        document.querySelector('#chatArea').scrollTop = document.querySelector('#chatArea').scrollHeight;
    }

    
    // 产品详细弹出
    function proInfoPopFun(n){
        var pinfoHTML = '<img src="/build/assets/img/pro/'+ n +'/pb.jpg" height="100%">' +
                        '<a href="javascript:void(0);" class="addlistlink">'+ n +'</a>';

        $(".proInfoPop_con").html(pinfoHTML);        
        $(".proInfoPop").show().css({"visibility": "visible"});

        clearTimeout(setTime);
        $(".proPop_con").removeClass("fadeInUp animated");
        $(".proPop").fadeOut().html("");
    }


    $(".pclose").on("click", function(){
        $(".proInfoPop").hide().css({"visibility": "hidden"});
        $(".proInfoPop_con").html("");
        showId.play();
    })


    // 添加到心愿单
    $(".proInfoPop").delegate(".addlistlink", "click", function(e){
        var ctVal = $(this).text();
        if(wishArr.indexOf(ctVal) < 0){
            wishArr.push($(this).text());
        }
        $(".wishlist em").html(wishArr.length);
        
        $(".proInfoPop").hide().css({"visibility": "hidden"});
        showId.play();

        e.preventDefault();
    })







    /* 串联流程 */
    $(".startBtn").on("click", function(){
        showId.play();
        $(".poster").hide();
        _v.sectionChange("stage");

        $(".wishlist em").html(wishArr.length);


        // 随机聊天
        chatset = setInterval(function(){
            chatFun(chatText[Math.floor(Math.random()*parseInt(chatText.length-1))]);
        }, 1900)

        
        pfun.eventTester(showId, "play", function(e){
            //clearInterval(chatset);
            $(".proInfoPop").hide().css({"visibility": "hidden"});
        })


        // swiper1 = new Swiper('#swiper-1', {
        //     slidesPerView: 2,
        //     paginationClickable: true,
        //     direction: 'vertical'
        // });

        swiper2 = new Swiper('#swiper-2', {
            direction: 'vertical'
        });

    })

    // 视频播放结束监测
    function prolistFunCreate(){
        clearInterval(chatset);

        _v.sectionChange("list");
        pfun.setCookie("wish", wishArr.toString(), "360");
        console.log(wishArr);

        // 提交心愿单结果
        var ischange = (historyWish != wishArr.join(','));
        if(wishArr.length > 0 && ischange){
            pfun.ajaxFun("POST", "/api/mark", {"mark": (wishArr.join(','))}, "json", markCallback);
        }

        var prolistArr = arrPos(wishArr);
        console.log(prolistArr);
        console.log(porinfoArr);

        var prolistHTML = $.map(prolistArr, function(v, k){
            // console.log(v + ":" + k);
            return '<div class="swiper-slide">' +
                        '<img src="/build/assets/img/pro/1/l.jpg" width="100%">' +
                        '<div class="proHotArea">' +
                            '<p>收藏人数: '+ porinfoArr.num[v] +'</p>' +
                            '<p class="price">'+ porinfoArr.price[v] +'</p>' +
                            '<div class="phabtnArea">' +
                                '<a href="'+ porinfoArr.link[v] +'" target="_blank" class="addCart">' +
                                    '<img src="/build/assets/img/addCart.jpg" width="100%">' +
                                '</a>' +
                                '<a href="javascript:void(0);" class="replay">' +
                                    '<img src="/build/assets/img/replay.jpg" width="100%">' +
                                '</a>' +
                            '</div>' +
                        '</div>' +
                    '</div>' ;
        }).join("");

        $("#prolistCon").html(prolistHTML);

        swiper3 = new Swiper('#swiper-3', {
            paginationClickable: true,
            nextButton: '#swiper-3 .swiper-button-next',
            prevButton: '#swiper-3 .swiper-button-prev',
            spaceBetween: 30
        });


    }
    pfun.eventTester(showId, "ended", function(e){
        prolistFunCreate();
    })

    $(".pass").on("click", function(){
        prolistFunCreate();
        showId.pause();
    })



    // arr pos change
    function arrPos(a){
        var b = [].concat(a);
        // console.log(b);
        for(var i = 1; i <= 5; i++){
            if(a.indexOf(i+"") < 0){
                b.push(i+"");
            }
        }
        return b;
    }



    console.log('cookie: ' + pfun.getCookie("wish"));
    // cookie 设置
    // pfun.setCookie("coachIsShare", "1", "360");
    // alert(pfun.getCookie("coachIsShare") + "set");
    // pfun.delCookie("coachIsShare");
    // console.log(pfun.getCookie("coachIsShare") + "del");





    

    function markCallback(data){
        console.log(data.status);
    }  



    pfun.loadingFnDoing(allimg, function(){
        $(".loading").css({"visibility": "hidden"});
        pfun.overscroll(document.querySelector("#chatArea")); 
        pfun.init();

        if(wishcookie && wishcookie.length > 0){
            prolistFunCreate();
        }else{
            _v.sectionChange("guide");
        }
    })


    $("#list").delegate(".replay", "click", function(e){
        _v.sectionChange("guide");
        e.preventDefault();
    })


    

    pfun.ajaxFun("POST", "/api/getmark", "", "json", function(data){
        //console.log(data);
        $.map(data.msg, function(o, l){
            //console.log(v + ":" +k);
            porinfoArr.num[l] = o;
        })
    });

</script></body></html>