<!DOCTYPE HTML>
<html>
<head>
    <title>COACH2017秋冬时装周</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="format-detection" content="telephone=no">
    <!-- uc强制竖屏 -->
    <meta name="screen-orientation" content="landscape">
    <!-- QQ强制竖屏 -->
    <meta name="x5-orientation" content="landscape">

    <!--禁用手机号码链接(for iPhone)-->
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0,minimal-ui" />
    <!--自适应设备宽度-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--控制全屏时顶部状态栏的外，默认白色-->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="Keywords" content="">
    <meta name="Description" content="...">
    <link rel="stylesheet" type="text/css" href="/build/assets/css/swiper.min.css">
    <link rel="stylesheet" type="text/css" href="/build/assets/css/main.min.css?v=0dae0feb9d">
    <style type="text/css">
        #orientLayer { display: block; }
        @media screen and (min-aspect-ratio: 13/9) { 
            #orientLayer { display: none; } 
        }
    </style>
    <script type="text/javascript" src="http://coach.samesamechina.com/api/v1/js/75058010-0fe1-476a-88f8-f96ffab561c8/wechat"></script>
</head>
<body>
<div class="loading">
    <div class="loading_con">
        <img src="/build/assets/img/logo.png?v=b7ab1cb4bc" width="100%">

        <div class="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
        </div>
        <p>目前涌入的小伙伴过多<br>页面正在跳转中，请耐心等待。</p>
    </div>
</div>

<!-- 横屏代码 -->
<div id="orientLayer" class="mod-orient-layer">
    <div class="mod-orient-layer__content">
        <i class="icon mod-orient-layer__icon-orient"></i>
        <div class="mod-orient-layer__desc">为了更好的体验，请使用竖屏浏览</div>
    </div>
</div>

<div id="dreambox">

    <p style="display:none">
      <img id="img1" src="/build/assets/img/blue.png?v=ccc1743280" alt="">
      <img id="img2" src="/build/assets/img/orange.png?v=1ce3e82ca1" alt="">
      <img id="img3" src="/build/assets/img/green.png?v=25f945040c" alt="">
      <img id="img4" src="/build/assets/img/pink.png?v=dbb3cb8037" alt="">
    </p>

    <div class="section show transition" id="guide">
        <div class="guideCon">
            <a href="javascript:void(0);" class="startBtn"></a>
        </div>
    </div>

    <div class="section" id="stage">

        <dl>
            <dd>
                <div class="poster"></div>
                <video width="100%" height="100%" id="show" x-webkit-airplay="true" preload playsinline webkit-playsinline src="http://nyfwfall2017video.samesamechina.com/build/assets/video/a.mp4"></video>

                <!-- <a class="alink" href="javascript:void(0);">
                    <img src="/build/assets/img/add.png?v=7584e93861" width="100%">
                </a> -->
            </dd>
            <dt>

                <div class="proPop">
                    
                    <!-- <div class="proPop_con" date-id="1">
                        <img src="/build/assets/img/pro/1/pw.png?v=b3b98bd091" width="100%">
                        <a href="javascript:void(0);" class="mlink">
                            <img src="/build/assets/img/mlink.png?v=6c443e913d" width="100%">
                        </a>
                    </div> -->

                </div>

                <div class="proInfoPop">
                    <a href="javascript:void(0)" class="pclose">
                        <img src="/build/assets/img/close.png?v=f144c02597" width="100%">
                    </a>
                    <div class="proInfoPop_con">
                        <!-- <img src="/build/assets/img/pro/1/pb.jpg?v=666e071068" height="100%">
                        <a href="javascript:void(0);" class="addlistlink">1</a> -->
                    </div>
                </div>

                <div class="wishlist">
                    <img src="/build/assets/img/bag.png?v=a9adb8b63c" width="100%">
                    <em>0</em>
                </div>
                <div class="chatlist">
                
                    <ul id="chatArea">
                        <li>通通加入心愿单~</li>
                        <!-- <li>天啦噜，每一款都想慢镜头好好欣赏一番！</li>
                        <li>新款的颜值已经超越天际，皮皮虾~我们走！</li>
                        <li>太幸福了，看中得几款，都可以在线买</li>
                        <li>每一件都看到爆炸，心愿单已经写不下了！</li> -->
                    </ul>
                    
                </div>
                <div class="chat">
                    <div class="chatfooter">
                        <div class="msg">
                            <input type="text" name="msgText" class="msgText" readonly>
                            <ul>
                                <li>通通加入心愿单~</li>
                                <li>天啦噜，每一款都想慢镜头好好欣赏一番！</li>
                                <li>新款的颜值已经超越天际，皮皮虾~我们走！</li>
                                <li>太幸福了，看中得几款，都可以在线买</li>
                                <li>每一件都看到爆炸，心愿单已经写不下了！</li>
                            </ul>
                            <input type="button" name="send" class="send" value="发送">
                        </div>
                    </div>

                    <div class="paopao">
                        <canvas id="myCanvas">您的浏览器不支持canvas标签~</canvas>
                        <a href="javascript:void(0);" class="heart">
                            <img src="/build/assets/img/heart.png?v=206ad21450" width="100%">
                        </a>
                    </div>
                    
                </div>
            </dt>
        </dl>

    </div>




    <div class="section" id="list">
        <img src="/build/assets/img/list-header.jpg?v=8719a7c927" width="100%">

        <div class="listCon">

            <!-- Swiper -->
            <div class="swiper-container" id="swiper-3">
                <div class="swiper-wrapper" id="prolistCon">
                    <!-- <div class="swiper-slide">
                        <img src="/build/assets/img/pro/1/l.jpg?v=7442bf886b" width="100%">

                        <div class="proHotArea">
                            <p>收藏人数: 520</p>
                            <p class="price">RMB8,500</p>
                            <div class="phabtnArea">
                                <a href="javascript:void(0)" class="addCart">
                                    <img src="/build/assets/img/addCart.png?v=d5609a2549" width="100%">
                                </a>
                                <a href="/" class="replay">
                                    <img src="/build/assets/img/replay.png?v=90865c27b2" width="100%">
                                </a>
                            </div>
                        </div>
                    </div>-->
                </div>
                <!-- Add Arrows -->
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>

        </div>

    </div>




</div>

<script type="text/javascript" src="/build/assets/js/main.min.js?v=87fca05d49"></script>
<script type="text/javascript">
    var allimg = [
        "/build/assets/img/logo.png?v=b7ab1cb4bc",
        "/build/assets/img/guide.jpg?v=5203e4cd85",

        "/build/assets/img/blue.png?v=ccc1743280",
        "/build/assets/img/orange.png?v=1ce3e82ca1",
        "/build/assets/img/green.png?v=25f945040c",
        "/build/assets/img/pink.png?v=dbb3cb8037",
    ];
    var wishcookie = pfun.getCookie("wish");
    var showId = document.getElementById("show"), timeArr = [], wishArr = !wishcookie ? [] : (wishcookie.split(','));

    pfun.loadingFnDoing(allimg, function(){
        $(".loading").css({"visibility": "hidden"});
        pfun.overscroll(document.querySelector("#chatArea")); 
        pfun.init();
    })

    $(".msgText").focus(function(e){
        $(".msg ul").css({"visibility": "visible"});
        e.preventDefault();
    })
    // .blur(function(){
    //     $(".msg ul").css({"visibility": "hidden"});
    // })

    $(".msg li").on("click", function(e){
        $(".msgText").val($(this).text());
        $(".msg ul").css({"visibility": "hidden"});
        e.preventDefault();
    })

    $("#chatArea").on("touchstart", function(){
        $(".msg ul").css({"visibility": "hidden"});
    })

    $(".send").on("click", function(){
        chatFun($(".msgText").val());
        $(".msgText").val("");
    })



    var demo, setDemo, chatset, swiper1, swiper2, swiper3;
    window.onload = function(){


    // window.onorientationchange = function(){
    //     switch(window.orientation){
    //         case -90:
    //         case 90:
    //         // $("#show").css({"width": "100%"});
    //         // alert("横屏:" + window.orientation);
    //         case 0:
    //         case 180:
    //         // $("#show").css({"width": "0"});
    //         //alert("竖屏:" + window.orientation);
    //         break;
    //     }
    // } 


      // 使用demo
      
      // demo2
      demo = new JumpBubble({
        elCanvas : document.getElementById("myCanvas"),
        config : {
          alpha : 0.5,
          width : 27
        },
        callback : function(a,b,c){}
      });
      clearInterval(setDemo);
      setDemo = setInterval(function(){
        var idName = "img" + Math.ceil(Math.random()*4);
        demo.create({
          elImg : document.getElementById(idName)
        });
      },290);



      $(".heart").on("touchstart", function(){
        //console.log(6);
        clearInterval(setDemo);
        setDemo = setInterval(function(){
            var idName = "img" + Math.ceil(Math.random()*4);
            demo.create({
              elImg : document.getElementById(idName)
            });
        },170);
      }).on("touchend", function(){
        //console.log(9);
        clearInterval(setDemo);
        setDemo = setInterval(function(){
            var idName = "img" + Math.ceil(Math.random()*4);
            demo.create({
              elImg : document.getElementById(idName)
            });
        },290);
      })

    }

    // 产品弹出
    function propopFun(n){
        var popHTML = '<div class="proPop_con" data-id="'+ n +'">' +
                        '<img src="/build/assets/img/pro/'+ n +'/pw.png" width="100%">' +
                        '<a href="javascript:void(0);" class="mlink">' +
                            '<img src="/build/assets/img/mlink.png?v=6c443e913d" width="100%">' +
                        '</a>' +
                    '</div>';
        $(".proPop").html(popHTML).stop().animate({"left": 0, "opacity": 1}, 200);
        

        setTimeout(function(){
            $(".proPop").stop().animate({"left": "100%", "opacity": 0}, 100).html("");
        }, 2700)

    }

    $(".proPop").delegate(".proPop_con", "click", function(){
        var currentNum = $(this).attr("data-id");
        console.log(currentNum);
        //swiper2.slideTo(currentNum, 1000, false);
        proInfoPopFun(currentNum);
        showId.pause();
    })


    

    pfun.eventTester(showId, "timeupdate", function(e){
        if(timeArr.indexOf(parseInt(showId.currentTime)) < 0){
            if(parseInt(showId.currentTime) == 3){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(1);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 9){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(2);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 15){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(3);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 20){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(4);
                //console.log(timeArr);
            }else if(parseInt(showId.currentTime) == 24){
                timeArr.push(parseInt(showId.currentTime));
                propopFun(5);
                //console.log(timeArr);
            }else {

            }
        }
        // console.log(parseInt(showId.currentTime))   
    });

    $(".poster").on("touchstart", function(){
        showId.play();
        $(this).hide();
    })


    // 随机聊天 
    var chatText = [
        "通通加入心愿单~",
        "天啦噜，每一款都想慢镜头好好欣赏一番！",
        "新款的颜值已经超越天际，皮皮虾~我们走！",
        "太幸福了，看中得几款，都可以在线买",
        "每一件都看到爆炸，心愿单已经写不下了！"
    ];

    function chatFun(t){
        var li = document.createElement('li');
            li.innerHTML = t;
            document.querySelector('#chatArea').appendChild(li);

        // 设置内容区的滚动条到底部
        document.querySelector('#chatArea').scrollTop = document.querySelector('#chatArea').scrollHeight;
    }

    
    // 产品详细弹出
    function proInfoPopFun(n){
        var pinfoHTML = '<img src="/build/assets/img/pro/'+ n +'/pb.jpg" height="100%">' +
                        '<a href="javascript:void(0);" class="addlistlink">'+ n +'</a>';

        $(".proInfoPop_con").html(pinfoHTML);        
        $(".proInfoPop").show().css({"visibility": "visible"});
    }


    $(".pclose").on("click", function(){
        $(".proInfoPop").hide().css({"visibility": "hidden"});
        $(".proInfoPop_con").html("");
        showId.play();
    })


    // 添加到心愿单
    $(".proInfoPop").delegate(".addlistlink", "click", function(e){
        var ctVal = $(this).text();
        if(wishArr.indexOf(ctVal) < 0){
            wishArr.push($(this).text());
        }
        $(".wishlist em").html(wishArr.length);
        
        $(".proInfoPop").hide().css({"visibility": "hidden"});
        showId.play();
        e.preventDefault();
    })

    // $(".addlistlink").on("click", function(e){
    //     var ctVal = $(this).text();
    //     if(wishArr.indexOf(ctVal) < 0){
    //         wishArr.push($(this).text());
    //     }
    //     $(".wishlist em").html(wishArr.length);
        
    //     $(".proInfoPop").hide().css({"visibility": "hidden"});
    //     showId.play();
    //     e.preventDefault();
    // })







    /* 串联流程 */
    $(".startBtn").on("click", function(){
        showId.play();
        $(".poster").hide();
        _v.sectionChange("stage");

        $(".wishlist em").html(wishArr.length);


        // 随机聊天
        chatset = setInterval(function(){
            chatFun(chatText[Math.floor(Math.random()*parseInt(chatText.length-1))]);
        }, 1900)

        
        pfun.eventTester(showId, "play", function(e){
            //clearInterval(chatset);
            $(".proInfoPop").hide().css({"visibility": "hidden"});
        })


        // swiper1 = new Swiper('#swiper-1', {
        //     slidesPerView: 2,
        //     paginationClickable: true,
        //     direction: 'vertical'
        // });

        swiper2 = new Swiper('#swiper-2', {
            direction: 'vertical'
        });

    })


    // 视频播放结束监测

    pfun.eventTester(showId, "ended", function(e){
        clearInterval(chatset);

        _v.sectionChange("list");
        pfun.setCookie("wish", wishArr.toString(), "360");
        console.log(wishArr);

        var prolistArr = arrPos(wishArr);
        console.log(prolistArr);

        var prolistHTML = $.map(prolistArr, function(v, k){
            // console.log(v + ":" + k);
            return '<div class="swiper-slide">' +
                        '<img src="/build/assets/img/pro/1/l.jpg?v=7442bf886b" width="100%">' +
                        '<div class="proHotArea">' +
                            '<p>收藏人数: '+ v +'</p>' +
                            '<p class="price">RMB8,500</p>' +
                            '<div class="phabtnArea">' +
                                '<a href="javascript:void(0)" class="addCart">' +
                                    '<img src="/build/assets/img/addCart.png?v=d5609a2549" width="100%">' +
                                '</a>' +
                                '<a href="/" class="replay">' +
                                    '<img src="/build/assets/img/replay.png?v=90865c27b2" width="100%">' +
                                '</a>' +
                            '</div>' +
                        '</div>' +
                    '</div>' ;
        }).join("");

        $("#prolistCon").html(prolistHTML);

        swiper3 = new Swiper('#swiper-3', {
            paginationClickable: true,
            nextButton: '#swiper-3 .swiper-button-next',
            prevButton: '#swiper-3 .swiper-button-prev',
            spaceBetween: 30
        });

    })



    // arr pos change
    function arrPos(a){
        var b = [];
        for(var i = 5; i > 0; i--){
            if(a.indexOf(i+"") < 0){
                b.push(i+"");
            }else{
                b.unshift(i+"");
            }
        }
        return b;
    }



    console.log('cookie: ' + pfun.getCookie("wish"));
    // cookie 设置
    // pfun.setCookie("coachIsShare", "1", "360");
    // alert(pfun.getCookie("coachIsShare") + "set");
    // pfun.delCookie("coachIsShare");
    // console.log(pfun.getCookie("coachIsShare") + "del");

</script>

</body>
</html>